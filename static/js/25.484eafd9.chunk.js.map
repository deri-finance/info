{"version":3,"sources":["utils/DeriNumberFormat.js","pages/AirDrop/img/time.svg","pages/AirDrop/img/pToken.svg","pages/AirDrop/AirDrop.js"],"names":["Wrapper","styled","NumberFormat","props","width","LoadLine","div","test","height","DeriNumberFormat","useState","className","renderablity","setRenderablity","firstTime","setFirstTime","isValidate","allowZero","value","undefined","isNaN","Math","abs","renderText","replace","useEffect","closeShowLoadingEffectAfterLoaded","wallet","defaultValue","others","decimalScale","bg","toFixed","countDecimal","toPlainString","displayType","fixedDecimalScale","thousandSeparator","timeout","window","setTimeout","clearTimeout","suffix","inject","observer","lang","type","balance","setBalance","disabled","setDisabled","alert","useAlert","info","setInfo","isWhite","setIsWhite","isPToken","setIsPToken","isExist","setIsExist","getBalance","a","isConnected","apiProxy","request","detail","chainId","account","res","getInfo","deadline","valid","timestamp","Date","getTime","click","includeResponse","success","error","isTransaction","transactionHash","response","data","link","blockExploreUrl","title","eqInNumber","isUserInPTokenWhiteListV3","isPTokenAirdroppedV3","isUserPTokenExistV3","formatAddress","src","tokenLogo","alt","timeLogo","Button","fontWeight","label","fontSize","onClick"],"mappings":"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","file":"static/js/25.484eafd9.chunk.js","sourcesContent":["import React,{useState,useEffect,useRef} from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport NumberFormat from 'react-number-format'\r\nimport { inject, observer } from 'mobx-react';\r\nimport styled from 'styled-components';\r\nimport { toPlainString,countDecimal } from './utils';\r\nimport { bg } from '../lib/web3js';\r\nconst Wrapper = styled(NumberFormat)`\r\n  width : ${props => props.width}px;\r\n`\r\nconst LoadLine = styled.div`\r\n  width : ${props => /px$/.test(props.width) ? props.width : `${props.width}px`};\r\n  height : ${props => /px$/.test(props.height) ? props.height : `${props.height}px`};\r\n`\r\nfunction DeriNumberFormat(props){\r\n  const [renderablity, setRenderablity] = useState(<span className='loading-line'></span>);\r\n  const [firstTime, setFirstTime] = useState(true)\r\n  const isValidate = () => {\r\n    const {allowZero} = props \r\n    return (typeof props.value !== 'object' && props.value !== undefined && props.value !== ''  && !isNaN(props.value) && props.value !== 'NaN') \r\n          || ((Math.abs(props.value)) === 0 && allowZero === true )\r\n  }\r\n  const renderText = value => value && value.replace(/\\.$/,'')\r\n\r\n  useEffect(() => {\r\n    const {allowZero,wallet,closeShowLoadingEffectAfterLoaded,defaultValue = '--',...others} = props \r\n\r\n    if(isValidate()) {\r\n      //如果精度截取之后为0，则动态获取精度，取到不为0为止\r\n      if(others.decimalScale > 0 && others.value && /\\d+\\.0*[1-9]+/.test(others.value)  && (+bg(others.value).toFixed((+others.decimalScale || 2))) === 0){\r\n        others.decimalScale = countDecimal(Math.abs(others.value)) + 2\r\n      } \r\n\r\n      if(others.decimalScale === -1 || ((+others.value) === 0 && allowZero)){\r\n        delete others.decimalScale\r\n      }\r\n\r\n      others.value = toPlainString(others.value)\r\n      if(others.value && /\\d+.9{6}/.test(others.value)){\r\n        others.value = (+others.value).toFixed(5)\r\n      }\r\n      setRenderablity(<Wrapper {...others}  renderText={renderText}\r\n      displayType = 'text'  fixedDecimalScale={true} thousandSeparator={true}/>)\r\n    } else if(firstTime){\r\n      const {width,height} = props\r\n      setRenderablity(<LoadLine className='loading-line' width={width} height={height}></LoadLine>)\r\n      if(closeShowLoadingEffectAfterLoaded){\r\n        setFirstTime(false)\r\n      }\r\n    } \r\n    const timeout = window.setTimeout(() => {\r\n      // && wallet && (!wallet.isConnected() || !wallet.supportChain)\r\n      if(!isValidate()){\r\n        setRenderablity(defaultValue)\r\n      }\r\n    },60000)\r\n    return () => {\r\n      clearTimeout(timeout)\r\n    };\r\n  }, [props.value,props.decimalScale,props.suffix]);\r\n\r\n  return renderablity;\r\n}\r\nexport default DeriNumberFormat\r\n// export default inject('wallet')(observer(DeriNumberFormat))","export default __webpack_public_path__ + \"static/media/time.77d9d1c0.svg\";","export default __webpack_public_path__ + \"static/media/pToken.f82ededf.svg\";","import { useState, useEffect } from 'react'\r\nimport { inject, observer } from 'mobx-react'\r\nimport { formatAddress, eqInNumber } from '../../utils/utils'\r\nimport { useAlert } from 'react-alert'\r\nimport DeriNumberFormat from '../../utils/DeriNumberFormat'\r\nimport Button from '../../components/Button/Button'\r\nimport apiProxy from '../../model/ApiProxy'\r\nimport timeLogo from './img/time.svg'\r\nimport tokenLogo from './img/pToken.svg'\r\nimport './airdrop.less'\r\nfunction AriDrop({ lang, wallet = {}, type = 'deri' }) {\r\n  const [balance, setBalance] = useState(0);\r\n  const [disabled, setDisabled] = useState(true);\r\n  const alert = useAlert();\r\n  const [info, setInfo] = useState({})\r\n  const [isWhite, setIsWhite] = useState(false)\r\n  const [isPToken, setIsPToken] = useState(true)\r\n  const [isExist, setIsExist] = useState(true)\r\n  const getBalance = async () => {\r\n    if (wallet.isConnected()) {\r\n      let res = await apiProxy.request('getDeriBalance', [wallet.detail.chainId, wallet.detail.account])\r\n      setBalance(res)\r\n    }\r\n  }\r\n  const getInfo = async () => {\r\n    let info = await apiProxy.request('getUserInfoAllForAirDrop', [wallet.detail.account])\r\n    let deadline = info.deadline * 1000\r\n    setInfo(info)\r\n    setDisabled(!info.valid)\r\n    let timestamp = new Date()\r\n    if (timestamp.getTime() >= deadline) {\r\n      setDisabled(true)\r\n    }\r\n    if (timestamp.getTime() >= 1647000000000) {\r\n      setDisabled(true)\r\n    }\r\n  }\r\n\r\n  const click = async () => {\r\n    if (type === 'pToken') {\r\n      let res = await apiProxy.request('airdropPTokenV3', [wallet.detail.chainId, wallet.detail.account], { includeResponse: true })\r\n      if (!res.success) {\r\n        alert.error(lang['claim-failed'])\r\n      }\r\n      if (res.success) {\r\n        alert.success('Claim Airdrop', {\r\n          timeout: 5000,\r\n          isTransaction: true,\r\n          transactionHash:res.response.data.transactionHash,\r\n          link: `${wallet.blockExploreUrl}/tx/${res.response.data.transactionHash}`,\r\n          title: 'Claim Airdrop Executed'\r\n        })\r\n        setDisabled(true)\r\n      }\r\n    } else {\r\n      if (!info.valid) {\r\n        alert.error(lang['no-deri-to-claim']);\r\n        return;\r\n      }\r\n      if (!eqInNumber(wallet.detail.chainId, info.chainId)) {\r\n        alert.error(lang['please-switch-to-BSC-to-claim-deri'])\r\n        return;\r\n      }\r\n      let res = await apiProxy.request('mintAirdrop', [info.chainId, wallet.detail.account], { includeResponse: true })\r\n      if (!res.success) {\r\n        alert.error(lang['claim-failed'])\r\n      }\r\n      if (res.success) {\r\n        setDisabled(true)\r\n      }\r\n      getBalance()\r\n    }\r\n\r\n  }\r\n\r\n  const isUserInPTokenWhiteListV3 = async () => {\r\n    let res = await apiProxy.request('isUserInPTokenWhiteListV3', [wallet.detail.chainId, wallet.detail.account])\r\n    setIsWhite(res)\r\n  }\r\n  const isPTokenAirdroppedV3 = async () => {\r\n    let res = await apiProxy.request('isPTokenAirdroppedV3', [wallet.detail.chainId, wallet.detail.account])\r\n    setIsPToken(res)\r\n  }\r\n\r\n  const isUserPTokenExistV3 = async () => {\r\n    let res = await apiProxy.request('isUserPTokenExistV3', [wallet.detail.chainId, wallet.detail.account])\r\n    setIsExist(res)\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (wallet.isConnected()) {\r\n      getBalance()\r\n      if (type === 'pToken') {\r\n        isUserInPTokenWhiteListV3()\r\n        isPTokenAirdroppedV3()\r\n        isUserPTokenExistV3()\r\n      } else {\r\n        getInfo()\r\n      }\r\n    }\r\n\r\n  }, [wallet, wallet.detail, type])\r\n\r\n  useEffect(() => {\r\n    if (isWhite && !isExist && !isPToken) {\r\n      let timestamp = new Date()\r\n      if (timestamp.getTime() >= 1649757600000) {\r\n        setDisabled(true)\r\n      } else {\r\n        setDisabled(false)\r\n\r\n      }\r\n    }\r\n  }, [isWhite, isExist, isPToken])\r\n  return (\r\n    <div className='airdrop-box'>\r\n      <div className='airdrop-info'>\r\n        <div className='airdrop-info-box'>\r\n          <div className='airdrop-title'>\r\n            {lang['title']}\r\n          </div>\r\n          <div className='wallet-address'>\r\n            <span className='blue-logo'></span>\r\n            {formatAddress(wallet.detail.account)}\r\n          </div>\r\n          <div className='wallet-balance'>\r\n            {lang['wallet-balance']} : <DeriNumberFormat value={balance} decimalScale={0} thousandSeparator={true} /> DERI\r\n          </div>\r\n          {type === 'pToken' && <div className='airdrop-time position-text'>\r\n            <div className='time-logo'>\r\n              <img src={tokenLogo} alt='' />\r\n            </div>\r\n            <div className='time-text'>\r\n              <div className='time-title'>\r\n                <div>\r\n                  Get free mBTC^2 perpetual\r\n                </div>\r\n                <div>\r\n                  powers position\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>}\r\n          {type === 'pToken' && <div className='airdrop-time position'>\r\n            <div className='time-logo'>\r\n              <img src={timeLogo} alt='' />\r\n            </div>\r\n            <div className='time-text'>\r\n              <div className='time-title'>\r\n                <div>\r\n                  {lang['start-time']}\r\n                </div>\r\n                <div>\r\n                  {lang['expire-time']}\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <div>\r\n                  2022-04-08 10:00:00 UTC\r\n                </div>\r\n                <div>\r\n                  2022-04-12 10:00:00 UTC\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>}\r\n          {type === 'deri' && <div className='airdrop-time'>\r\n            <div className='time-logo'>\r\n              <img src={timeLogo} alt='' />\r\n            </div>\r\n            <div className='time-text'>\r\n              <div className='time-title'>\r\n                <div>\r\n                  {lang['start-time']}\r\n                </div>\r\n                <div>\r\n                  {lang['expire-time']}\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <div>\r\n                  2022-03-09 10:00:00 UTC\r\n                </div>\r\n                <div>\r\n                  2022-03-11 12:00:00 UTC\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>}\r\n\r\n          <div className='claim'>\r\n            <Button fontWeight='bold' disabled={disabled} label={lang['claim']} width='277' height='72' fontSize='32' onClick={click} />\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\nexport default inject('wallet', 'poolManager')(observer(AriDrop))"],"sourceRoot":""}