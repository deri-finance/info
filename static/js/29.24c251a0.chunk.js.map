{"version":3,"sources":["pages/Governance/DipTwo.js"],"names":["inject","observer","wallet","lang","optionOne","setOptionOne","useState","optionTwo","setOptionTwo","optionThree","setOptionThree","checkedOption","setCheckedOption","userVote","setUserVote","userPower","setUserPower","countVote","setCountVote","sumVote","setSumVote","timestamp","setTimestamp","radioChange","e","value","target","getUserVote","async","res","apiProxy","request","detail","account","option","getUserPower","getVoting","num","alert","error","useEffect","interval","window","setInterval","isConnected","className","href","rel","type","name","id","onChange","event","defaultChecked","for","label","width","fontSize"],"mappings":"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","file":"static/js/29.24c251a0.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { inject, observer } from 'mobx-react'\nimport './dip.less'\nimport Button from '../../components/Button/Button'\nimport apiProxy from '../../model/ApiProxy'\nfunction DipTwo({ wallet = {}, lang }) {\n  const [optionOne, setOptionOne] = useState(false)\n  const [optionTwo, setOptionTwo] = useState(false)\n  const [optionThree, setOptionThree] = useState(false)\n  const [checkedOption, setCheckedOption] = useState('')\n  const [userVote, setUserVote] = useState('')\n  const [userPower, setUserPower] = useState('')\n  const [countVote, setCountVote] = useState([])\n  const [sumVote, setSumVote] = useState('')\n  const [timestamp, setTimestamp] = useState('')\n  const radioChange = (e) => {\n    let { value } = e.target\n    setCheckedOption(value)\n  }\n  const voteBtn = async () => {\n    if (!checkedOption) {\n      alert(lang['please-choose-your-vote-first'])\n      return\n    }\n    let res = await isOk()\n    if (res) {\n      getUserVote()\n      getUserPower()\n      getVoting()\n    }\n  }\n\n  const isOk = async () => {\n    let res = await apiProxy.request('vote', [wallet.detail.chainId, wallet.detail.account, checkedOption], { includeResponse: true })\n    if (res.success) {\n      let bool = true\n      while (bool) {\n        let data = await apiProxy.request('getUserVotingResult', [wallet.detail.account])\n        if (data.timestamp) {\n          data.timestamp > timestamp ? bool = false : bool = true\n        } else {\n          data.timestamp ? bool = false : bool = true\n        }\n      }\n      return true;\n    }\n  }\n\n\n  const getUserVote = async () => {\n    let res = await apiProxy.request('getUserVotingResult', [wallet.detail.account])\n    if (res) {\n      if (res.option === '1') {\n        setOptionOne(true)\n        setUserVote(\"I\")\n      } else if (res.option === '2') {\n        setOptionTwo(true)\n        setUserVote(\"II\")\n      } else if (res.option === '3') {\n        setOptionThree(true)\n        setUserVote(\"III\")\n      }\n      setTimestamp(res.timestamp)\n    }\n  }\n\n  const getUserPower = async () => {\n    let res = await apiProxy.request('getUserVotingPower', [wallet.detail.account])\n    if (res) {\n      setUserPower(res)\n    }\n  }\n\n  const getVoting = async () => {\n    let res = await apiProxy.request('getVotingResult', [])\n    if (res) {\n      let num = +res[0] + (+res[1]) + (+res[2])\n      setCountVote(res)\n      setSumVote(num)\n    } else {\n      alert(res.error)\n    }\n  }\n\n  useEffect(() => {\n    let interval = null;\n    interval = window.setInterval(() => {\n      getVoting()\n    }, 1000)\n  }, [])\n  useEffect(() => {\n    let interval = null;\n    if (wallet.isConnected()) {\n      interval = window.setInterval(() => {\n        getUserPower()\n        getUserVote()\n      }, 1000)\n    }\n  }, [wallet, wallet.detail.account])\n  return (\n    <div className='dip-box'>\n      <div className='dip-box-info'>\n        <div className='dip-info dip-two-info'>\n          <div className='dip-info-title'>\n            <div className='dip-title'>\n              {lang['dip-two']}\n            </div>\n            <div className='dip-des'>\n              <div>{lang['governance-describe']}</div>\n              <div>{lang['governance-describe-two']}</div>\n              <div>\n                {lang['governance-describe-three']} <a target='_blank' href='https://docs.deri.io/mining-faq#what-do-i-harvest-for-liquidity-mining'  rel='noreferrer' >{lang['governance-describe-three-a']}</a>  {lang['governance-describe-three-one']}\n              </div>\n            </div>\n          </div>\n          <div className='dip-options'>\n            <div className='dip-options-checked'>\n              <div className='checkbox'>\n                <input\n                  type='radio'\n                  name='option'\n                  value='1'\n                  id=\"I\"\n                  onChange={event => radioChange(event)}\n                  defaultChecked={optionOne}\n                />\n                <label for='I'>I.</label>\n              </div>\n              <div className='option-describe'>\n                <div>\n                  <div>\n                    {lang['governance-options-one-describe']}\n                  </div>\n                </div>\n\n              </div>\n              <div className='peng'>\n                <div className='peng-box'>\n                  <div className='peng-bg dip-two-one'></div>\n                  <div className='peng-num'>\n                    142,989 DERI\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className='dip-options-checked'>\n              <div className='checkbox'>\n                <input\n                  type='radio'\n                  name='option'\n                  value='2'\n                  id=\"II\"\n                  onChange={event => radioChange(event)}\n                  defaultChecked={optionTwo}\n                />\n                <label for='II'>II.</label>\n              </div>\n              <div className='option-describe'>\n                <div>\n                  \n                  <div>\n                    {lang['governance-options-two-describe']}\n                  </div>\n                </div>\n\n              </div>\n              <div className='peng'>\n                <div className='peng-box'>\n                  <div className='peng-bg dip-two-two'></div>\n                  <div className='peng-num'>\n                    1,440,582 DERI\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className='dip-options-checked'>\n              <div className='checkbox'>\n                <input\n                  type='radio'\n                  name='option'\n                  value='3'\n                  id=\"III\"\n                  onChange={event => radioChange(event)}\n                  defaultChecked={optionThree}\n                />\n                <label for='III'>III.</label>\n              </div>\n              <div className='option-describe'>\n                <div>\n                  <div>\n                    {lang['governance-options-three']}\n                  </div>\n                </div>\n\n              </div>\n              <div className='peng'>\n                <div className='peng-box'>\n                  <div className='peng-bg dip-two-three'></div>\n                  <div className='peng-num'>\n                    0 DERI\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className='vote-button'>\n              <Button label={lang['vote']} width='332' fontSize='18' />\n            </div>\n          </div>\n\n        </div>\n        <div className='voting-rules dip-two-rules'>\n          <div className='voting-rules-title'>\n            {lang['voting-rules']} :\n            </div>\n          <div className='voting-info'>\n            <div>1. {lang['vote-rules-one']}</div>\n            <div>{lang['vote-rules-one-describe-one']}</div>\n            <div>{lang['vote-rules-one-describe-two']}</div>\n            <div>{lang['vote-rules-one-describe-three']}</div>\n            <div>{lang['vote-rules-one-describe-four']}</div>\n          </div>\n          <div className='voting-info'>\n            <div>2.{lang['vote-rules-two']}</div>\n          </div>\n          <div className='voting-info'>\n            <div>3.{lang['vote-rules-three']}</div>\n          </div>\n          <div className='voting-info'>\n            <div>4.{lang['vote-rules-four']}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\nexport default inject('wallet')(observer(DipTwo))\n\n"],"sourceRoot":""}